<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.11.2/URI.min.js"></script>
    <script type="text/javascript">
      // Force HTTPS
      var enforce = "juris-m.github.io";
      if ((enforce == window.location.host) && (window.location.protocol != "https:")) {
          // GitHub API OAuth login robot calls back with HTTP, even if protocol is set to HTTPS in the URL.
          window.location.protocol = "https";
      } else {
          // Access token is global to this window
          var access_token;
          if (!access_token) {
              access_token = localStorage.getItem('access_token');
          }
          // GitHub login
          uri = new URI();
          if (uri.hasQuery('code')) {
              // Get temporary code
              var code = uri.query(true)['code'];
              // Remove code from URL
              history.replaceState({}, document.title, uri.search(""));
              // Call for validation
              var mode = "default";
              if (document.location.host === "fbennett.github.io") {
                  mode = "dev";
              }
              var url = 'https://our.law.nagoya-u.ac.jp/juris-m/authenticate/' + code + '?case=' + mode;
              var xhr = new XMLHttpRequest();
              xhr.open('GET', url, true);
              xhr.setRequestHeader("Content-type","application/json");
              xhr.onload = function(e) {
                  if (xhr.readyState === 4) {
                      if (xhr.status === 200) {
                          console.log("XXX RESPONSE: "+xhr.responseText);
                          var obj = JSON.parse(xhr.responseText);
                          // Set our access token
                          if (obj.token) {
                              console.log("GitHub login success\n");
                              access_token = obj.token;
                              window.localStorage.setItem('access_token', access_token);
                          }
                      } else {
                          console.log("XXX OOPS in main(3): " + xhr.statusText + "\n");
                      }
                  }
              }
              xhr.onerror = function (e) {
                  console.log("XXX OOPS in main(4): " + e + "\n");
              }
              xhr.send(null);
          }
      }
    </script>
    <title>Juris-M: Editor</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="../favicon-32x32.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito">
    <link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono:700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../css/jquery-ui.1.11.3.min.css">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
    <link rel="stylesheet" type="text/css" href="../css/fileinput.min.css">
    <link rel="stylesheet" type="text/css" href="../css/ladda-themeless.min.css">
    <link rel="stylesheet" type="text/css" href="../css/screen.css">
    <script src="../js/jquery.1.11.3.min.js"></script>
    <script src="../js/jquery-ui.1.11.3.min.js"></script>
    <script src="../js/jquery.ui.touch-punch.min.js"></script>
    <script src="../js/typeahead.bundle.js"></script>
    <script src="../js/underscore-min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="../js/fileinput.min.js" type="text/javascript"></script>
    <script src="../js/spin.min.js"></script>
    <script src="../js/ladda.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.8/ace.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/tutorial.js"></script>
    <script>

    /* code originally for scrolling
     * Ahnsirk Dasarp
     * http://stackoverflow.com/questions/5007530/how-do-i-scroll-to-an-element-using-javascript
     */
    function setBoxHeight(lst, reduction, minHeight) {
        if (!reduction) {
            reduction = 0;
        }
        var docViewHeight = document.documentElement.clientHeight;
        for (var i=0,ilen=lst.length;i<ilen;i++) {
            var obj = document.getElementById(lst[i]);
            if (!obj) return;
            var origObj = obj;
            origObj.style['min-height'] = (minHeight ? minHeight : 200) + 'px';
            //if (document.documentElement.clientWidth < 992) {
            //    continue;
            //}
            var offset = 0;
            if (lst[i] === 'error-list') {
                offset = 8;
            }
            var curtop = 0;
            var curleft = 0;
            if (obj.offsetParent) {
                do {
                    curtop += obj.offsetTop;
                } while (obj = obj.offsetParent);
                var boxHeight = (docViewHeight - curtop - 5);
                origObj.style['height'] = ((boxHeight - offset + reduction) + 'px');
                origObj.style['max-height'] = ((boxHeight - offset + reduction) + 'px');
            } else {
                // for field-map-menu-container
                if (lst[i] === 'field-map-menu-container') {
                    var offsetTop = $('div.container.content').get(0).offsetTop;
                    origObj.style['height'] = ((docViewHeight - offsetTop - offset + reduction) + 'px');
                    origObj.style['max-height'] = ((docViewHeight - offsetTop - offset + reduction) + 'px');
                }
            }
        }
    }
    

      $(function() {
        $( "#tabs" ).tabs({active:0});
      });
      hljs.initHighlightingOnLoad();
    </script>
  </head>
  <body onload="CSLValidator.init();">
    <div class="modal fade" id="editCslVar" tabindex="-1" role="dialog" aria-labelledby="editCslVarLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="editCslVarLabel"><span class="mono" id="cslFieldLabel"></span> <span class="mono" id="cslVarName">Boo</span></h4>
          </div>
          <div class="modal-body name">
	        <div class="wrapper name">
	          <div class="row">
		        <div class="col-lg-1">
		          <label style="display:none;"><input type="checkbox" id="csl-name-checkbox-1" checked="true" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" placeholder="default" id="csl-family-name-1">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" placeholder="default" id="csl-given-name-1">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-2" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-2">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-2">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-3" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-3">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-3">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-4" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-4">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-4">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-5" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-5">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-5">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-6" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-6">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-6">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-7" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-7">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-7">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-8" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-8">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-8">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-9" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-9">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-9">
	              </div>
		        </div>
              </div>
	          <div class="row">
		        <div class="col-lg-1">
		          <label><input type="checkbox" id="csl-name-checkbox-10" class="input-group-addon" value=""></label>
		        </div>
		        <div class="col-lg-6">
	              <div class="input-group">
		            <span class="input-group-addon">Last:</span>
		            <input type="text" class="form-control" id="csl-family-name-10">
	              </div>
		        </div>
		        <div class="col-lg-5">
	              <div class="input-group">
		            <span class="input-group-addon">First:</span>
		            <input type="text" class="form-control" id="csl-given-name-10">
	              </div>
		        </div>
              </div>
	        </div>
	        <div class="wrapper date">
	          <div class="input-group">
		        <span class="input-group-addon" id="csl-date-label">Date:</span>
		        <input type="text" class="form-control" placeholder="default" aria-described-by="csl-date-label" id="csl-date">
	          </div>
	        </div>
	        <div class="wrapper number">
	          <div class="input-group">
		        <span class="input-group-addon" id="csl-number-label">Number:</span>
		        <input type="text" class="form-control" placeholder="default" aria-described-by="csl-number-label" id="csl-number">
	          </div>
	        </div>
	        <div class="wrapper text">
	          <div class="input-group">
		        <span class="input-group-addon" id="csl-text-label">Text:</span>
		        <input type="text" class="form-control" placeholder="default" aria-described-by="csl-text-label" id="csl-text">
	          </div>
	        </div>
	        <div class="wrapper locator">
	          <div class="input-group">
		        <span class="input-group-addon" id="csl-locator-label">Locator:</span>
		        <input type="text" class="form-control" placeholder="default" aria-described-by="csl-locator-label" id="csl-locator">
	          </div>
	        </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button id="editCslVarSave" type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>
    <div id="banner" class="container">
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div id="juris-m-button" class="navbar-brand" style="padding-top:5px;" onclick="window.location.href=window.location.href.replace('/editor', '')">
              <img src="../image/juris-m-logo.svg" style="height:40px;"/>
            </div>
          </div>
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
              <li><a id="editorViewButton" class="action-button chosen" onclick="CSLValidator.setView(event,'editor');" href="#">Style Editor</a></li>
              <li class="dropdown">
                <a id="field-maps" href="#" class="dropdown-toggle" role="button" data-toggle="dropdown" aria-expanded="false">
                  Field Maps
                  <span class="caret"></span></a>
                <ul id="field-map-menu-container" class="dropdown-menu action-button" role="menu" onclick="CSLValidator.setView(event,'fields',event.originalTarget ? event.originalTarget.textContent : event.srcElement.textContent)">
                  <li><a href="#">Placeholder</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a id="documentation" href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Docs <span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a href="http://docs.citationstyles.org/en/stable/specification.html">CSL Specification</a></li>
                  <li><a href="http://citationstylist.org/docs/citeproc-js-csl.html">Juris-M (CSL-m) Specification Supplement</a></li>
                </ul>
              </li>
              <li><a id="github-link" href="#" style="display:none;">GitHub View</a></li>
              <li><a id="tutorial" href="#" style="padding-top:10px;padding-bottom:10px;" onclick="tutorial.build();tutorial.run();"><img style="height:30px;" src="../image/question.svg"/></a></li>
              <li><a id="tutorial" href="#" style="padding-top:10px;padding-bottom:10px;" onclick="tutorial.build();tutorial.toggle_guidance();"><img style="height:30px;" src="../image/info.svg"/></a></li>
            </ul>
          </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
      </nav>
    </div>
    <div class="container content">
      <div id="editor-view" class="container action-view">
	    <div class="row">
	      <div class="col-lg-6">
	        <div class="input-append input-group">
	          <div id="source-method" value="search-source" class="input-group-btn">
		        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Source <span class="caret"></span></button>
		        <ul class="dropdown-menu" role="menu">
		          <li><a value="search-source" href="#">Jurisdiction Module</a></li>
		          <li><a value="file-source" href="#">File Upload</a></li>
		          <li><a id="last-source" value="url-source" href="#">URL</a></li>
		        </ul>
	          </div><!-- /btn-group -->
	          <div id="search-source" class="source-input">
                <input id="search-input" autocomplete="off" class="typeahead form-control" type="text" placeholder="Enter a country or institution">
	          </div>
	          <div id="file-source" class="row source-input" style="display:none;">
                <div class="col-xs-12">
                  <input class="file form-control" id="file-input" type="file" data-show-preview="false" data-show-upload="false">
                </div>
	          </div>
	          <span id="url-source" class="source-input" style="display:none;">
                <input class="form-control" id="url-input" type="text" placeholder="Enter style URL">
	          </span>
	          <span id="search-source-remover" class="input-group-btn source-input-remover" style="display:none;">
		        <button class="btn btn-default" title="Clear Jurisdiction" type="button"><i class="glyphicon glyphicon-trash"></i> Remove</button>
              </span>
              <span id="url-source-remover" class="input-group-btn source-input-remover" style="display:none;">
		        <button class="btn btn-default" title="Clear URL" type="button"><i class="glyphicon glyphicon-trash"></i> Remove</button>
              </span>
	        </div>
	      </div>
	      <div class="col-lg-3">
	        <div class="input-group">
	          <div id="schema-version" value="1.1mlz1" class="input-group-btn">
		        <button id="load-source" type="button" class="btn btn-primary ladda-button" data-style="zoom-in" disabled=""><span class="ladda-label">Load</span></button>
                <button id="schema-version-caret" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">with <span class="caret"></span></button>
                <ul id="schema-version-dropdown" class="dropdown-menu" role="menu">
                  <li><a value="1.1mlz1" href="#">Juris-M</a></li>
                  <li><a value="1.0.1" href="#">CSL 1.0.1</a></li>
                  <li><a value="1.0" href="#">CSL 1.0</a></li>
                  <li><a value="0.8.1" href="#">CSL 0.8.1</a></li>
                </ul>
              </div><!-- /btn-group -->
              <input class="form-control" id="schema-name" readonly="true" value="Juris-M" type="text">
            </div><!-- /input-group -->
          </div><!-- /.col-s-6 -->
          <div class="col-lg-3">
	        <button id="validate" type="button" class="btn btn-primary ladda-button" data-style="zoom-in"><span class="ladda-label">Validate </span></button>
	        <button id="save" type="button" class="btn btn-primary ladda-button" data-style="zoom-in"><span class="ladda-label">Download </span></button>
	        <button id="submit" type="button" class="btn btn-success ladda-button" data-style="zoom-in"><span class="ladda-label">Submit </span></button>
          </div>
        </div>
        <div class="row row-gap">
          <div class="col-sm-12">
            <div id="alert"></div>
            <div id="tabs">
	          <ul>
		        <li><a id="source-tab" onclick="CSLValidator.setView(event,'editor');" href="#source">Editor</a></li>
		        <li><a id="errors-tab" href="#errors">Errors</a></li>
		        <li><a id="sampler-tab" href="#sampler">Sampler</a></li>
	          </ul>
	          <div id="source">
                <!-- img style="height:250px;" src="../image/question.svg"/ -->
                <div id="source-guidance" class="guidance">
                  <h2>Juris-M Style Editor</h2>
                  <div class="multi-column">
                      <div class="keep-together toc" style="padding:0.5em;margin-bottom:1em;border:1px solid #000000;border-radius:1em;">
                        <div><b>Contents</b></div>
                        <ul>
                          <li><a href="#guidance-introduction">Introduction</a></li>
                          <li><a href="#guidance-loading">Loading Module Code</a></li>
                          <li><a href="#guidance-initial">Initial Setup</a></li>
                          <li><a href="#guidance-components">Scaffolding and Components</a></li>
                          <li><a href="#guidance-citations">Components and Citations</a></li>
                          <li><a href="#guidance-jurisdiction">Jurisdiction and Item Types</a></li>
                          <li><a href="#guidance-custom">Custom field values</a></li>
                          <li>Components: full-form
                            <ul>
                              <li><a href="#guidance-title"><span class="mono">juris-title</span></a></li>
                              <li><a href="#guidance-main"><span class="mono">juris-main</span></a></li>
                              <li><a href="#guidance-default-spotter"><span class="mono">juris-default-spotter</span></a></li>
                              <li><a href="#guidance-comma-spotter"><span class="mono">juris-comma-spotter</span></a></li>
                              <li><a href="#guidance-tail"><span class="mono">juris-tail</span></a></li>
                            </ul>
                          </li>
                          <li>Components: short-form
                            <ul>
                              <li><a href="#guidance-title-short"><span class="mono">juris-title-short</span></a></li>
                              <li><a href="#guidance-main-short"><span class="mono">juris-main-short</span></a></li>
                              <li><a href="#guidance-default-spotter-short"><span class="mono">juris-default-spotter-short</span></a></li>
                              <li><a href="#guidance-comma-spotter-short"><span class="mono">juris-comma-spotter-short</span></a></li>
                              <li><a href="#guidance-tail-short"><span class="mono">juris-tail-short</span></a></li>
                            </ul>
                          </li>
                          <li>Components: fragments
                            <ul>
                              <li><a href="#guidance-locator-label"><span class="mono">juris-locator-label</span></a></li>
                              <li><a href="#guidance-locator"><span class="mono">juris-locator</span></a></li>
                            </ul>
                          </li>
                          <li><a href="#guidance-results">Test Results</a></li>
                        </ul>
                      </div>
                      <h2 id="guidance-introduction"><a class="return-link" href="#banner">Introduction</a></h2>
                      <p>
                        This is a tutorial on authoring legal styles for
                        the Juris-M research manager. To illustrate the
                        process, we will walk through the creation of a
                        module for the sunken kingdom
                        of <span class="small-caps">Atlantis</span>, an
                        imaginary jurisdiction with just two citation
                        forms:
                      </p>
                      <ul>
                        <li>Int’l Shoe Co. v. Wash., 90 L. Ed. 95 (Sup. Ct. 1945)</li>
                        <li>Sherwood Act, ch. 123, 37 Stat. 112 (1912).</li>
                      </ul>
                      <p>
                        The first form is for citations to court
                        judgments (the <b>Case</b> type, in Juris-M
                        terms). The second is to the official record
                        of original legislation (corresponding to
                        the <b>Gazette</b> type).
                      </p>
                      <p>
                        You may wish to create the module yourself as
                        you read through this document.  The style
                        editor will overlay the tutorial when it is
                        opened, but you can toggle the document view
                        at any time using the
                        <img src="../image/info.svg"
                        style="height:1.2em;"/> info icon above.
                      </p>
                      <p>
                        Juris-M style modules are written in a variant
                        of the Citation Style Language (CSL). No prior
                        programming experience is necessary: if you
                        have some familiarity with HTML and the
                        patience to read a little documentation, you
                        will find that CSL is rather easy to work
                        with.
                      </p>
                      <p>
                        You should budget at least an hour to work through
                        the tutorial. The sections below provide code blocks
                        that can be pasted into a template to quickly create the
                        sample style for <span class="small-caps">Atlantis</span>;
                        but you should take time to study the comments and
                        be sure that you understand the structure and logic of
                        the code.
                      </p>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>

                  <h3>Getting Started</h3>
                  <div class="multi-column">

                    <h2 id="guidance-loading"><a class="return-link" href="#banner">Loading Module Code</a></h2>

                    <p>
                      Begin by loading the style module for
                      <span class="small-caps">Atlantis</span>, which (as you
                      may have anticipated) is a subjurisdiction of
                      <span class="small-caps">Laputa</span>.
                      Two steps are required to load the style:
                      <ol>
                        <li>
                          Type <span class="mono">Laputa</span> into
                          the <span class="buttony gray">Source</span>
                          search box, and select it from the dropdown
                          list.  The search box with fill with a
                          torquoise <span class="buttony
                          turquoise">Laputa</span> label.
                        </li>
                        <li>
                          Select our sub-jurisdiction by clicking the
                          caret on the right side of the
                          <span class="buttony
                          turquoise">Laputa</span> label, and choosing
                          from the dropdown list
                          (<span class="mono">Atlantis</span> will be
                          the only listed item&mdash;Laputa is one of
                          the smaller imaginary jurisdictions).
                        </li>
                        <li>
                          Click on the <span class="buttony">Load</span>
                          button.
                        </li>
                      </ol>
                      If you have not done so already, this would be a
                      good time to take a tour of the toolbar buttons
                      by clicking on the
                      <img src="../image/question.svg"
                      style="height:1.2em;"/> question-mark icon.  The
                      tour will step through the overall workflow,
                      giving you an idea of where this is all headed.
                    </p>

                    <h2 id="guidance-initial"><a class="return-link" href="#banner">Initial Setup</a></h2>
                    
                    <p>
                      A module
                      for <span class="small-caps">Atlantis</span>
                      does not yet exist, so the editor will load a
                      template when you first call it. At the top of
                      the file, you will find a <code>cs:info</code>
                      block (the <code>cs:</code>
                      prefix is our shorthand for "CSL code block").
                      Some of the details are filled in automatically
                      (<span class="mono">zz</span> is the ISO code
                      for imaginary countries).
                    </p>
                    <pre><code class="xml">&lt;info&gt;
  &lt;title&gt;ZZ, Atlantis&lt;/title&gt;
  &lt;id&gt;http://citationstylist.org/modules/juris-zz:zz&lt;/id&gt;
  &lt;link href="http://citationstylist/modules/juris-zz:zz" rel="self"/&gt;
  &lt;link href="http://juris-m.github.io" rel="documentation"/&gt;
  &lt;author&gt;
    &lt;name&gt;YOUR-NAME-HERE&lt;/name&gt;
    &lt;email&gt;YOUR-EMAIL-ADDRESS-HERE&lt;/email&gt;
  &lt;/author&gt;
  &lt;category citation-format="note"/&gt;
  &lt;category field="law"/&gt;
  &lt;summary&gt;Juris-M style module for ZZ, Atlantis&lt;/summary&gt;
  &lt;updated&gt;2013-01-26T22:06:38+00:00&lt;/updated&gt;
  &lt;rights license="http://creativecommons.org/licenses/by-sa/3.0/"&gt;This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License&lt;/rights&gt;
&lt;/info&gt;</code></pre>
                    <p>
                      To get started, fill in your name and email
                      address to take credit for your work. Press
                      the <span class="buttony">Validate</span> button,
                      wait for validation to complete, and then press
                      <span class="buttony green">Submit</span>.
                    </p>
                    <p>
                      If all goes well, the editor will save the
                      change to your personal GitHub repository and
                      report success (if there is an error, wait a
                      minute and try again&mdash;it sometimes takes a
                      little time for GitHub to catch up with us the
                      first time around).
                    </p>
                  </div>
                  
                  <hr style="border:0 none;border-top:1px solid #000000;"/>

                  <h3>Module Composition</h3>

                  <div class="multi-column">

                    <h2 id="guidance-components"><a class="return-link" href="#banner">Scaffolding and Components</a></h2>
                    <p>
                      After loading the style, select
                      the <span class="tabby">Sampler</span> tab to
                      preview the current output of the module for the
                      default <b>Case</b> type. The first item listed,
                      which obviously needs some work, looks like
                      this:
                    </p>
                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Full plain</div>
                        <div>
                          [TITLE], [MAIN], [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL]
                        </div>
                      </div>
                    </div>
                    <p>
                      You can use the dropdown selector to choose
                      the <b>Gazette</b> type, which displays the same
                      unsightly "citations":
                    </p>
                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Full plain</div>
                        <div>
                          [TITLE], [MAIN], [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL]
                        </div>
                      </div>
                    </div>
                    <p>
                      This illustrates an important point about
                      modular CSL: citations are composed of subunits
                      plugged into a fixed template. In this tutorial,
                      we will refer to the template
                      as <i>scaffolding</i>, and to the subunits
                      as <i>components</i>.
                    </p>
                    <p>
                      Scaffolding controls the punctuation between
                      components, the typeface used for the title, and
                      back-reference forms such as
                      <i>ibid</i> and <i>supra</i>.
                    </p>
                    <p>
                      In our module
                      for <span class="small-caps">Atlantis</span>,
                      the scaffolding is contained in
                      the <code>cs:citation</code> element, at the
                      bottom of the file. We will not touch this
                      code&mdash;it is, in fact, <i>not</i> part of
                      the module code. In production, our module will
                      be called by another, more general style
                      (<i>Chicago Full
                      Note</i>, <i>APA</i>, <i>OSCOLA</i>, etc.), and
                      the calling style will supply its own
                      scaffolding for the module components.
                    </p>
                    <p>
                      The components of the module are its
                      <code>cs:macro</code> elements.  A
                      module <i>must</i> contain a full set of
                      <span class="mono">juris-</span>prefixed macros.
                      (A module with missing macros may test
                      successfully, but calling styles will ignore it.) Here is the full
                      list of required macro names:
                    </p>
                    <div class="inline-blocks">
                      <div class="inline-block">
                        <span class="mono">juris-title</span><br/>
                        <span class="mono">juris-main</span><br/>
                        <span class="mono">juris-default-spotter</span><br/>
                        <span class="mono">juris-comma-spotter</span><br/>
                        <span class="mono">juris-tail</span><br/>
                        <span class="mono">juris-locator-label</span>
                      </div>
                      <div class="inline-block">
                        <span class="mono">juris-title-short</span><br/>
                        <span class="mono">juris-main-short</span><br/>
                        <span class="mono">juris-default-spotter-short</span><br/>
                        <span class="mono">juris-comma-spotter-short</span><br/>
                        <span class="mono">juris-tail-short</span><br/>
                        <span class="mono">juris-locator</span>
                      </div>
                    </div>
                    
                    <h2 id="guidance-citations"><a class="return-link" href="#banner">Components and Citations</a></h2>

                    <p>
                      Components are the building blocks from which we
                      will construct printed citations. To that end,
                      we need to visualize the samples in terms of the
                      macro component categories: <span class="boxy
                      noborder mono
                      greenish">title</span>, <span class="boxy
                      noborder mono
                      yellowish">main</span>, <span class="boxy
                      noborder mono reddish">locator</span>
                      and <span class="boxy noborder mono
                      blueish">tail</span>. Through our
                      Juris-M-colored spectacles, the samples look
                      something like this:
                    </p>
                    <div class="well">
                      <span class="boxy greenish">Int’l Shoe Co. v. Wash.</span>, <span class="boxy yellowish">90 L. Ed. 95</span>, <span class="boxy reddish">96</span> <span class="boxy blueish">(Sup. Ct. 1945)</span>
                    </div>
                    <p>
                    </p>
                    <div class="well">
                      <span class="boxy greenish">Sherwood Act</span>, <span class="boxy yellowish">ch. 123</span>, <span class="boxy reddish">§ 3,</span> <span class="boxy blueish">37 Stat. 112, <span class="boxy reddly">113</span> (1912)</span>
                    </div>
                    <p>
                      The secondary pinpoint to page 113 in the second
                      sample (marked by a brighter-red highlight) is
                      small wrinkle in the design that will be
                      discussed in detail a bit later. Meanwhile, note
                      that the division between the blocks depends
                      only on the position of the pinpoint locator:
                      the components are purely <i>visual</i> units,
                      and have no special semantic significance.
                    </p>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>

                  <h3>Module Selection</h3>

                  <div class="multi-column">

                    <h2 id="guidance-jurisdiction"><a class="return-link" href="#banner">Jurisdiction and Item Types</a></h2>
                    <p>
                      As noted above, we will require just two
                      citation types for
                      the <span class="small-caps">Atlantis</span>
                      jurisdiction: <b>Case</b> and <b>Gazette</b>. This
                      reflects actual practice, where a
                      sub-jurisdiction may have special citation
                      requirements for only certain types of
                      material. We can limit our module to these two
                      types by inserting the following code as
                      the <i>last</i> element inside
                      the <code>cs:info</code> element:
                    </p>
                    <pre><code class="xml">&lt;law-module types="legal_case gazette"/&gt;</code></pre>
                    <p>
                      Note that the name used for the
                      Juris-M <b>Case</b> type in CSL code is
                      <span class="mono">legal_case</span>, and that
                      for the <b>Gazette</b> type
                      is <span class="mono">legislation</span>&mdash;see
                      below for a full list of the Juris-M legal types
                      and their CSL equivalents.
                    </p>
                    <div class="well yellowish">
                      <b>Note:</b> After validating, you can and
                      should save your work by clicking
                      the <span class="buttony green">Submit</span>
                      button. Otherwise, your changes will be lost
                      when you refresh the editor or reenter it at
                      a later time.
                    </div>
                    <p>
                      When the style is validated with this new code,
                      all but these two item types will be disabled in
                      the the dropdown menu in
                      the <span class="tabby">Sampler</span>.
                    </p>
                    <p>
                      When citations are processed in a production
                      environment, this module-level item-type
                      constraint will have the following effect:
                    </p>
                    <ul>
                      <li>
                        When the processor receives an item that is
                        stamped with
                        the <span class="small-caps">Atlantis</span>
                        jurisdiction, it will check to see:
                        <ol>
                          <li>
                            if there is
                            an <span class="small-caps">Atlantis</span>
                            module; and
                          </li>
                          <li>
                            if the module supports the type of the
                            item.
                          </li>
                        </ol>
                      </li>
                      <li>
                        If the module exists and supports the type of
                        the input, the module code will be used to
                        render the item.
                      </li>
                      <li>
                        If either condition fails, the processor will
                        repeat the process for the parent jurisdiction.
                      </li>
                      <li>
                        If the module hierarchy is exhausted without finding
                        a match, the code of the calling style will be used
                        to render the item.
                      </li>
                    </ul>
                    <p>
                      For example, if we input an item of
                      the <b>Hearing</b> type
                      (<span class="mono">hearing</span>), the
                      processor will ignore our module code, and
                      instead attempt to use
                      the <span class="small-caps">Laputa</span>
                      module, if one exists; and if it has no luck
                      there, it will use the default code of the
                      original "ancestor" style that sent out the call
                      for modular code.
                    </p>
                    <p>
                      For reference, the Juris-M legal item types and their
                      CSL equivalents are as follows:
                    </p>
                    <div  style="margin:0 2em;">
                      <table class="table">
                        <thead style="font-weight:bold;">
                          <td>Juris-M label</td><td>CSL variable</td>
                        </thead>
                        <tbody>
                          <tr>
                            <td>Bill</td><td class="mono">bill</td>
                          </tr>
                          <tr>
                            <td>Case</td><td class="mono">legal_case</td>
                          </tr>
                          <tr>
                            <td>Gazette</td><td class="mono">gazette</td>
                          </tr>
                          <tr>
                            <td>Hearing</td><td class="mono">hearing</td>
                          </tr>
                          <tr>
                            <td>Regulation</td><td class="mono">regulation</td>
                          </tr>
                          <tr>
                            <td>Report</td><td class="mono">report</td>
                          </tr>
                          <tr>
                            <td>Statute</td><td class="mono">legislation</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <p>
                      We are now <i>almost</i> ready to begin composing citations;
                      but first, we will set up the test data for our samples.
                    </p>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>

                  <h3>Sample Data</h3>

                  <div class="multi-column">
                    <h2 id="guidance-custom"><a class="return-link" href="#banner">Custom Field Values</a></h2>
                    <p>
                      We will need some test data to preview the code we are
                      about to write for the components. The editor will provide
                      supply default values for the various CSL input
                      variables, but the automatically generated content can
                      be difficult to interpret in the display. Let's begin
                      by setting up the values that we expect to see in the
                      finished citations.
                    </p>
                    <p>
                      In the <span class="tabby">Sampler</span>, set the
                      item type to <b>Case</b>, and click on the <span class="buttony bubble">Case
                        Name</span> bubble. In the popup that appears,
                      enter <span class="mono">Int’l Shoe
                        Co. v. Wash.</span>, and click on
                      the <span class="buttony">Save changes</span>
                      button. Nothing will change in the citation display (yet),
                      but you can check that the value has been saved by
                      clicking on the bubble again.
                    </p>
                    <p>
                      Proceed in the same fashion for the remaining citation
                      data. Here are the values to set for <b>Case</b>:
                    </p>
                    <div style="margin:0 2em;">
                      <table class="table monos">
                        <thead style="font-weight:bold;">
                          <tr>
                            <td>Bubble</td>
                            <td>Value</td>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>
                              <span class="buttony bubble">Short Title</span>
                            </td>
                            <td>
                              Int'l Shoe
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Reporter Volume</span>
                            </td>
                            <td>
                              90
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Reporter</span>
                            </td>
                            <td>
                              L. Ed.
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">First Page</span>
                            </td>
                            <td>
                              95
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Court</span>
                            </td>
                            <td>
                              Sup. Ct.
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Date Decided</span>
                            </td>
                            <td>
                              1945
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Locator</span>
                            </td>
                            <td>
                              100
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <p>
                      In production data, you may prefer to enter the
                      full name of the <span class="buttony
                      bubble">Reporter</span>
                      as <span class="mono">Lawyer's Edition</span>,
                      and the value of <span class="buttony
                      bubble">Court</span> will be set to the internal
                      identifier for <span class="mono">Supreme Court</span>.
                      The Juris-M Abbreviation Filter can be used to transform
                      full-form entries and internal codes to the correct
                      citation form; but for testing, we are good to just
                      set the literal abbreviated values in these fields.
                    </p>
                    <p>
                      Here are the values to set in the <b>Gazette</b> view:
                    </p>
                    <div style="margin:0 2em;">
                      <table class="table monos">
                        <thead style="font-weight:bold;">
                          <tr>
                            <td>Bubble</td>
                            <td>Value</td>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>
                              <span class="buttony bubble">Name of Act</span>
                            </td>
                            <td>
                              Sherwood Act
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Short Title</span>
                            </td>
                            <td>
                              Sherwood Act
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Public Law Number</span>
                            </td>
                            <td>
                              ch. 123
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Volume</span>
                            </td>
                            <td>
                              37
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Reporter</span>
                            </td>
                            <td>
                              Stat.
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Pages</span>
                            </td>
                            <td>
                              112
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Date Enacted</span>
                            </td>
                            <td>
                              1912
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Section</span>
                            </td>
                            <td>
                              9
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="buttony bubble">Locator</span>
                            </td>
                            <td>
                              &amp; sec. 10 | 115
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <p>
                      Here again, in production data you may prefer to enter
                      <span class="mono">Statutes at Large</span> as the value
                      of the <span class="buttony bubble">Reporter</span> field.
                      We will use the abbreviated value for testing, but
                      we will explain how to enable support for the Juris-M
                      Abbreviation Filter below.
                    </p>
                    <div class="well yellowish">
                      <b>Note:</b> Custom field data is stored in your
                      browser, and takes effect for all styles. The
                      values will persist across page refreshes and
                      browser restarts, but if you access the editor
                      from another browser or computer, you will need
                      to re-enter them.
                    </div>
                    <p>
                      Now that our sample data is in place, we are ready to
                      start coding the module!
                    </p>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>

                  <h3>Full-form components</h3>

                  <div class="multi-column">
                    <h2 id="guidance-title"><a class="return-link" href="#banner"><span class="mono">juris-title</span></a></h2>
                    <p>
                      To include the title in full-form citations,
                      replace
                      the <span class="mono">juris-title</span> macro
                      with the following code:
                    </p>
                    <div>
                    <pre><code class="xml">&lt;macro name="juris-title"&gt;
  &lt;choose&gt;
    &lt;if type="legal_case"&gt;
      &lt;text variable="title" form="short"/&gt;
    &lt;/if&gt;
    &lt;else&gt;
      &lt;text variable="title"/&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                    </div>
                    <p>
                      As mentioned above, the Juris-M Abbreviation
                      Filter is able to abbreviate field content. When
                      the <code>form="short"</code>
                      attribute is set on the <span class="mono">title</span> of a legal
                      citation type, the Filter will attempt to apply
                      abbreviations from an external database of words, phrases
                      and full titles.
                    </p>

                    <p>
                      In the legal style
                      of <span class="small-caps">Atlantis</span>,
                      the titles of legislation are never abbreviated.
                      Accordingly, we use a <code>cs:choose</code>
                      conditional statement to limit abbreviation to the
                      <span class="mono">legal_case</span> type.
                    </p>
                    <p>
                      You can read more about condition statements in
                      the CSL Specification, linked in the <b>Docs</b>
                      menu above.
                    </p>

                    <div class="keep-together">
                      <p>
                        After validation, the first-listed item in
                        the <span class="tabby">Sampler</span> 
                        with the <b>Case</b> type is selected should look like this:
                      </p>

                      <div>
                        <div class="well">
                          <div class="indent">
                            <div class="small-faint-heading">Full plain</div>
                            <div>
                              Int’l Shoe Co. v. Wash., [MAIN], [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL]
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <p>
                      When the <b>Gazette</b> type is selected, it should show this:
                    </p>

                    <div>
                      <div class="well">
                        <div class="indent">
                          <div class="small-faint-heading">Full plain</div>
                          <div>
                            Sherwood Act, [MAIN], [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL]
                          </div>
                        </div>
                      </div>
                    </div>

                    <p>
                      The titles are drawn from
                      the <span class="buttony bubble">Case
                      Name</span> and <span class="buttony
                      bubble">Name of Act</span> fields; drag them to
                      the <b>Excluded fields</b> box to remove them,
                      and restore them by dragging them back. This is
                      a handy way of testing our module code with
                      various combinations of input.
                    </p>
                    <div>
                      <div class="well blueish">
                        <b>Note:</b> The limited short-form behaviour
                        described above is specific to
                        the <span class="mono">title</span> variable
                        of legal item
                        types. When <code>form="short"</code> is
                        applied to the
                        the <span class="mono">title</span> variable
                        of a <i>non-legal</i> item, Juris-M will first
                        attempt to
                        render <span class="mono">title-short</span>
                        (the <span class="buttony bubble">Short
                        Title</span> field), and fall back
                        to <span class="mono">title</span> only if no
                        value is found there.
                      </div>
                    </div>

                  </div>
                  
                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Full-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-main"><a class="return-link" href="#banner"><span class="mono">juris-main</span></a></h2>
                    <p>
                      In the previous section,
                      our <span class="mono">juris-title</span>
                      component tested for item type, and rendered the
                      title in the appropriate form with
                      a <code>cs:text</code> element.  Turning to
                      the <span class="mono">juris-main</span>
                      component, we note that the <b>Case</b>
                      and <b>Gazette</b> types will again require
                      (very) different treatment:
                    </p>
                    <div class="well well-sm">
                      Int’l Shoe Co. v. Wash., <span class="boxy yellowish">90 L. Ed. 95</span>, 96 (Sup. Ct. 1945)
                    </div>
                    <div class="well well-sm">
                      Sherwood Act, <span class="boxy yellowish">ch. 123</span>, § 3, 37 Stat. 112, 113 (1912)
                    </div>
                    <p>
                      Accordingly, we apply a test for item type in
                      the code for <span class="mono">juris-main</span>.
                    </p>
                    <div class="well well-sm greenish">
                      See below for the code of the <span class="mono">juris-main</span> component.
                    </div>

                    <h3>The <span class="mono">legal_case</span> block</h3>
                    <p>
                      The code
                      for <span class="mono">legal_case</span>
                      introduces two new CSL
                      elements. The <span class="mono">volume</span>
                      and <span class="mono">page-first</span>
                      variables must be rendered
                      using <code>cs:number</code> (rather than
                      <code>cs:text</code>) because these
                      are <i>numeric variables</i> in the Juris-M
                      flavour of CSL. You can check the category of
                      the variables available in each item type by
                      visiting the
                      <b>Field Maps</b> menu at the top of this page.
                    </p>
                    <p>
                      The three elements rendered
                      by <span class="mono">juris-main</span> in
                      the <b>Case</b> type are joined together by
                      wrapping them in a <code>cs:group</code>
                      element. We add a space between each element
                      by setting <code>delimiter="&nbsp;"</code> on
                      the group. (In passing, note the use of
                      the <code>form="short"</code> attribute, which
                      will apply an abbreviation to the reporter name
                      if one is available.)
                    </p>
                    <h3>The <span class="mono">gazette</span> block</h3>
                    <p>
                      In the <span class="small-caps">Atlantis</span>
                      jurisdiction, laws passed in 1978 and after are
                      assigned a unique Public Law Number in the
                      official gazette, which should be given the
                      label &ldquo;Pub. L. No.&rdquo;. Laws passed
                      before 1978 were numbered by "chapter" in each
                      legslative session, and should be labelled with
                      &ldquo;ch.&rdquo;.
                    </p>
                    <p>
                      The <code>number</code> field recognizes a set
                      of <i>short-code prefixes</i> that map to
                      pre-defined labels. We can use a short-code
                      prefix in our input data to distinguish between
                      the two types of numbering in the official
                      gazette. Short-code prefixes are removed from
                      the field, but they set a label name for which
                      we can test, and the label can be rendered
                      with a <code>cs:label</code> element.
                    </p>
                    <div class="well well-sm greenish">
                      See below for a full list of the <span class="mono">number</span> short-code prefixes
                    </div>
                    <p>
                    </p>
                    <p>
                      When no short-code prefix is given,
                      the test <code>number="number"</code> will return <code>true</code>,
                      because &ldquo;number&rdquo; is the default label
                      value for the <code>number</code> field. 
                      In our test data, we have marked
                      the <span class="buttony bubble">Public Law
                      Number</span> value with the short-code prefix
                      <span class="mono">ch.</span>, which changes the
                      label associated with the <code>number</code>
                      field to <code>chapter</code>: with our input
                      data, the test <code>number="number"</code> will
                      return <code>false</code>, and the component will
                      render the chapter label.
                    </p>
                    <p>
                      From the user's perspective, all that is needed
                      is to set the <span class="mono">ch.</span>
                      prefix on the <style class="buttony
                                                  bubble">Public Law Number</style> of pre-1978
                      legislation items
                      of <span class="small-caps">Atlantis</span>; the
                      citation processor and the module will take care of
                      the details.
                    </p>
                    <p>
                      That said, we are not <i>quite</i> finished with
                      the <span class="mono">juris-main</span>
                      component. The label short-code is not used
                      directly: it is written in the form specified on
                      the <code>cs:label</code> element, using data
                      supplied by the standard CSL locales. The
                      standard abbreviation of
                      <span class="mono">chapter</span>
                      is <span class="mono">chap.</span>, as we can
                      see in the citation shown in
                      the <span class="tabby">Sampler</span>:
                    </p>
                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Full plain</div>
                        <div>
                          Sherwood Act, chap. 50, [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL]
                        </div>
                      </div>
                    </div>
                    <p>
                      To get the form we expect to see
                      in <span class="small-caps">Atlantis</span>
                      citations, add this block of code immediately after the closing
                      tag of the <code>cs:info</code> element:
                    </p>
                    <pre><code class="xml">&lt;locale&gt;
  &lt;terms&gt;
    &lt;term form="symbol" name="chapter"&gt;ch.&lt;/term&gt;
  &lt;/terms&gt;
&lt;/locale&gt;</code></pre>
                    <p>
                      This will override the standard locale for testing purposes&mdash;but
                      note that this is non-modular code: the "ancestor" style
                      that calls our module will apply its own locale settings when
                      rendering the component.
                    </p>
                    <p>
                      To learn more about CSL locales, refer to the CSL Specification,
                      linked in the <b>Docs</b> menu at the top of this page.
                    </p>
                  </div>

                  <hr style="border:0 none;border-top:1px dashed #000000;"/>

                  <div class="row">
                    <div class="col-sm-6">
                      <p>
                        Code for the <span class="mono">juris-main</span> component
                      </p>
                    <pre><code class="xml">&lt;macro name="juris-main"&gt;
  &lt;choose&gt;
    &lt;if type="legal_case"&gt;
      &lt;group delimiter=" "&gt;
        &lt;number variable="volume"/&gt;
        &lt;text variable="container-title" 
              form="short"/&gt;
        &lt;number variable="page-first"/&gt;
      &lt;/group&gt;
    &lt;/if&gt;
    &lt;else&gt;
      &lt;choose&gt;
        &lt;if number="number"&gt;
          &lt;group delimiter=" " suffix=","&gt;
            &lt;text value="Pub. L. No."/&gt;
            &lt;number variable="number"/&gt;
          &lt;/group&gt;
        &lt;/if&gt;
        &lt;else&gt;
          &lt;group delimiter=" " suffix=","&gt;
            &lt;label variable="number" 
                   form="symbol"/&gt;
            &lt;number variable="number"/&gt;
          &lt;/group&gt;
        &lt;/else&gt;
      &lt;/choose&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                    </div>
		    
		            <div class="col-sm-6">
		              
                      <p>
                        Short-codes recognized on the <span class="mono">number</span> variable
                      </p>
		              <div class="row">
			            <div class="col-sm-6">
			              <table class="table short-codes">
                            <thead>
                              <tr>
				                <td>
				                  Short-code
				                </td>
				                <td>
				                  Label
				                </td>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
				                <td>
				                  art.
				                </td>
				                <td>
				                  article
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  bk.
				                </td>
				                <td>
				                  book
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  ch.
				                </td>
				                <td>
				                  chapter
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  col.
				                </td>
				                <td>
				                  column
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  fig.
				                </td>
				                <td>
				                  figure
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  fol.
				                </td>
				                <td>
				                  folio
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  no.
				                </td>
				                <td>
				                  issue
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  l.
				                </td>
				                <td>
				                  line
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  n.
				                </td>
				                <td>
				                  note
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  op.
				                </td>
				                <td>
				                  opus
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  p.
				                </td>
				                <td>
				                  page
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  pp.
				                </td>
				                <td>
				                  page
				                </td>
                              </tr>
                            </tbody>
			              </table>
			            </div>
			            <div class="col-sm-6">
			              <table class="table short-codes">
                            <thead>
                              <tr>
				                <td>
				                  Short-code
				                </td>
				                <td>
				                  Label
				                </td>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
				                <td>
				                  para.
				                </td>
				                <td>
				                  paragraph
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  pt.
				                </td>
				                <td>
				                  part
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  r.
				                </td>
				                <td>
				                  rule
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  sch.
				                </td>
				                <td>
				                  schedule
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  sec.
				                </td>
				                <td>
				                  section
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  subch.
				                </td>
				                <td>
				                  subchapter
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  subpara.
				                </td>
				                <td>
				                  subparagraph
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  subsec.
				                </td>
				                <td>
				                  subsection
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  sv.
				                </td>
				                <td>
				                  sub-verbo
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  tit.
				                </td>
				                <td>
				                  title
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  vrs.
				                </td>
				                <td>
				                  verse
				                </td>
                              </tr>
                              <tr>
				                <td>
				                  vol.
				                </td>
				                <td>
				                  volume
				                </td>
                              </tr>
                            </tbody>
			              </table>
			            </div>
                      </div>
		            </div>
		          </div>

                  
                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Full-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-default-spotter"><a class="return-link" href="#banner"><span class="mono">juris-default-spotter</span></a></h2>
                    <p>
                      The <span class="mono">spotter</span> components
                      set a pinpoint locator in the native format of
                      the module. Scaffolding should call
                      the <span class="mono">comma</span> variant
                      first, followed by
                      the <span class="mono">default</span> variant
                      discussed here. If the components are properly
                      composed, only one of them will render: to
                      understand why, we need to take a closer look at
                      the CSL <code>cs:group</code> element, and at the
                      behaviour of the <code>locator</code> variable
                      in Juris-M CSL.
                    </p>
                    <p>
                      Once-only rendering of the <code>locator</code>
                      variable is a feature of Juris-M CSL. As stated
                      in the Specification Supplement (linked in
                      the <b>Docs</b> menu at the top of this page):
                    </p>
                    <div class="well">
                      The locator variable will render exactly once in
                      a citation; subsequent attempts will render
                      nothing. As with variables suppressed
                      via <b>cs:substitute</b>, the test
                      for <span class="mono">variable="locator"</span>
                      will continue to return true after the variable
                      is suppressed from further output.
                    </div>
                    <p>
		              Suppression of output extends to labels or terms
		              grouped together with a
		              suppressed <code>locator</code> variable, as
		              indicated in the CSL Specification.
                    </p>
                    <div class="well">
                      <b>cs:group</b> implicitly acts as a
                      conditional: <b>cs:group</b> and its child
                      elements are suppressed if:
                      <ul>
                        <li>
                          at least one rendering element in <b>cs:group</b> calls a variable
                          (either directory or via a macro), and
                        </li>
                        <li>all variables that are called are empty.</li>
                      </ul>
                      This accommodates descriptive <b>cs:text</b> [and <b>cs:label</b>] elements.
                      <div><i>(brace-enclosed text added)</i></div>
                    </div>
		            <p>
		              Reading these two rules together, we can
		              efficiently achieve one-time-only rendering of
		              locators and labels in
		              the <span class="mono">spotter</span> components
		              by following these guidelines:
		            </p>
		            <ul>
		              <li>
			            Locator labels must be grouped together with
			            a locator element, at the same nesting level (N.B.
			            macros open a new nesting level); and
		              </li>
		              <li>
			            The condition <code>variable="locator"</code> must
			            be used only to test for the complete absence of
			            the variable in the item input.
		              </li>
		            </ul>
                    <p>
                      At this point, we need to confirm the format of pinpoint
                      locators in the native style of our jurisdiction. Rummaging about for our
                      dog-eared copy of
                      <span class="small-caps">The Atlantis Guide: A
                      Very Old System of Citation</span>, we find that
                      they should look like this for a long-form
                      reference of the <b>Case</b> type:
                    </p>
                    <div class="well well-sm">
                      Int’l Shoe Co. v. Wash., 90 L. Ed. 95, <span class="boxy reddish">96</span> (Sup. Ct. 1945) 
                    </div>
                    <p>
                      In the <b>Gazette</b> type, section pinpoints should look like this:
                    </p>
                    <div class="well well-sm">
                      Sherwood Act, ch. 123, <span class="boxy reddish">§ 3</span>, 37 Stat. 112, 113 (1912)
                    </div>
                    <p>
                      The first point to note is that the pinpoint
                      locator is preceded by a comma in both
                      instances. The locators will therefore not be
                      rendered by this component, but by
                      its <span class="mono">comma</span> companion.
                      It does not follow, however, that we have nothing
                      to define here.
                    </p>
		            <p>
		              Because scaffolding will attempt to
		              render <span class="mono">juris-comma-spotter</span>
		              before reaching
		              the <span class="mono">juris-default-spotter</span>
		              component, the latter (our component of the
		              moment) will not contain any explicit conditions
		              to suppress output: it is sufficient to render
		              the <code>locator</code> variable and its
		              (optional) label inside a <code>cs:group</code>
		              element, laid out as appropriate for the native style.
		            </p>
		            <p>
                      If
		              the <span class="mono">juris-default-spotter</span>
		              component renders without explicit conditions,
		              it can be invoked by other macros in our module,
		              and will produce output without fail (after
		              which the <code>locator</code> variable will be
		              suppressed, of course). Since locators are
		              composed in a uniform way
		              across <span class="mono">Atlantis</span>
		              references (i.e. applying a label to all locator
		              types except <span class="mono">page</span>), we
		              can invoke it as shorthand for the label/locator
		              combination elsewhere in the module. (There is
		              no guarantee that this must be so, but it will
		              likely be the case in many other style
		              modules&mdash;hence
		              the <span class="mono">default</span> moniker on
		              this component.)
		            </p>
                    <p>
                      Here is our Juris-M CSL code to produce the standard
                      pinpoint unit for <span class="small-caps">Atlantis</span>
                      references:
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-default-spotter"&gt;
  &lt;group delimiter=" "&gt;
    &lt;choose&gt;
      &lt;if match="none" locator="page"&gt;
        &lt;label variable="locator"/&gt;
      &lt;/if&gt;
    &lt;/choose&gt;
    &lt;text macro="juris-locator"/&gt;
  &lt;/group&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Full-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-comma-spotter"><a class="return-link" href="#banner"><span class="mono">juris-comma-spotter</span></a></h2>
                    <p>
                      Now that we have our <span class="mono">default</span> pinpoint
                      component in hand, let&rsquo;s take another look at the
                      comma-separated pinpoints in context:
                    </p>
                    <div class="well well-sm">
                      Int’l Shoe Co. v. Wash., 90 L. Ed. 95, <span class="boxy reddish">96</span> (Sup. Ct. 1945) 
                    </div>
                    <div class="well well-sm">
                      Sherwood Act, ch. 123, <span class="boxy reddish">§ 3,</span> 37 Stat. 112, 113 (1912)
                    </div>
                    <p>
                      A second point to note is that the section pinpoint on the <b>Gazette</b>
                      item is followed by a comma. Standard scaffolding separates a pinpoint
                      from the <span class="mono">juris-tail</span> component with a space,
                      so we will resort to a minor dirty trick to insert the comma.
                    </p>
                    <p>
                      In the code below, we call
                      the <span class="mono">default</span> macro to
                      render the pinpoint unit, but on
                      the <b>Gazette</b> type, when there is
                      a <span class="mono">container-title</span>
                      variable (corresponding to
                      the <span class="buttony bubble">Reporter</span>
                      field), we append a comma with
                      a <code>suffix=","</code> attribute. (Requiring
                      the variable is a bit gratuitous, since a
                      <b>Gazette</b> cite in our jurisdiction that
                      lacks a <span class="buttony bubble">Reporter</span>
                      value will be broken anyway, but it at least
                      serves as an illustration of multiple
                      conditions.)
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-comma-spotter"&gt;
  &lt;choose&gt;
    &lt;if match="all" type="gazette" 
        variable="container-title"&gt;
      &lt;text macro="juris-default-spotter" suffix=","/&gt;
    &lt;/if&gt;
    &lt;else&gt;
      &lt;text macro="juris-default-spotter"/&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                    <p>
                      We are now ready to complete the code for
                      full-form references by turning to
                      the <span class="mono">juris-tail</span>
                      component.
                    </p>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Full-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-tail"><a class="return-link" href="#banner"><span class="mono">juris-tail</span></a></h2>
                    <!-- zzz -->
                    <p>
                      The <span class="mono">tail</span> portion of
                      our citations differs considerably. For
                      the <b>Gazette</b> type, it also contains a
                      wrinkle that we adverted to earlier: we will now
                      need to deal with it.
                    </p>
                    <div class="well well-sm">
                      Int’l Shoe Co. v. Wash., 90 L. Ed. 95, 96 <span class="boxy blueish">(Sup. Ct. 1945)</span> 
                    </div>
                    <div class="well well-sm">
                      Sherwood Act, ch. 123, § 3, <span class="boxy blueish">37 Stat. 112, <span class="boxy reddly">113</span> (1912)</span>
                    </div>
                    <p>
                      The common feature of the two citations is the
                      trailing parenthetical.  The year fields
                      (<span class="buttony bubble">Date
                      Decided</span> and <span class="buttony
                      bubble">Date Enacted</span> respectively) both
                      map to the CSL <span class="mono">issued</span>
                      variable.  The court name is drawn from
                      the <span class="buttony bubble">Court</span>
                      field corresponds to the Juris-M
                      CSL <span class="mono">authority</span>
                      variable, which has no mapping from
                      the <b>Gazette</b> type, so there is no overlap
                      in the current Juris-M schema. We can therefore
                      use the same code to render the parenthetical
                      for both types.
                    </p>
                    <p>
                      While <span class="buttony bubble">Court</span>
                      is an ordinary text field in the Juris-M Desktop Client,
                      the processor treats it as an institutional name.
                      As noted earlier, its value will be a court identifier
                      code in actual production, converted by the Abbreviation
                      Filter. To enable conversion, it is set to the short
                      form on the <code>cs:institution</code> element. For
                      the full details on the <code>cs:institution</code> element,
                      see the Juris-M CSL Specification Supplement, linked
                      in the <b>Docs</b> menu at the top of this page.
                    </p>
                    <p>
                      In the <code>type="gazette"</code> condition
                      block, we render the elements of the reporter
                      citation needed for <b>Gazette</b> items. The
                      &ldquo;wrinkle&rdquo; posed by the additional pinpoint
                      locator (<span class="boxy reddly">113</span>) is covered
                      to the <span class="mono">locator-extra</span> variable,
                      which can be set in the <span class="buttony bubble">Locator</span>
                      field by appending it with a <span class="mono">|</span> vertical bar
                      character&mdash;see the Juris-M CSL Specification Supplement, linked
                      from the <b>Docs</b> menu at the top of this page, for details and
                      an example.
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-tail"&gt;
  &lt;group delimiter=" "&gt;
    &lt;choose&gt;
      &lt;if type="gazette"&gt;
        &lt;number variable="volume"/&gt;
        &lt;text variable="container-title" form="short"/&gt;
        &lt;group delimiter=", "&gt;
          &lt;number variable="page-first"/&gt;
          &lt;text variable="locator-extra"/&gt;
        &lt;/group&gt;
      &lt;/if&gt;
    &lt;/choose&gt;
    &lt;group delimiter=" " prefix="(" suffix=")"&gt;
      &lt;names variable="authority"&gt;
        &lt;name/&gt;
        &lt;institution institution-parts="short"/&gt;
      &lt;/names&gt;
      &lt;date form="text" date-parts="year" variable="issued"/&gt;
    &lt;/group&gt;
  &lt;/group&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;margin-bottom:10px;"/>
                  <hr style="border:0 none;border-top:1px solid #000000;margin-top:10px;"/>

                  <h3>Short-form components</h3>

                  <div class="multi-column">

                    <h2 id="guidance-title-short"><a class="return-link" href="#banner"><span class="mono">juris-title-short</span></a></h2>
                    <p>
                      Our scaffolding calls
                      the <span class="mono">juris-title-short</span>
                      component in subsequent citations. As that macro
                      is still delivering a placeholder,
                      the <b>Case</b> type is still showing this in the <span class="tabby">Sampler</span>:
                    </p>
                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Supra plain</div>
                        <div>
                          <i>[TITLE-SHORT]</i>, [MAIN-SHORT], [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL-SHORT]
                        </div>
                      </div>
                    </div>
                    <p>
                      The <b>Gazette</b> type is showing roughly the
                      same thing&mdash;the only difference is that the
                      title placeholder is set in a roman rather than
                      italic type:
                    </p>
                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Supra plain</div>
                        <div>
                          [TITLE-SHORT], [MAIN-SHORT], [COMMA-LOCATOR] [SPACE-LOCATOR] [TAIL-SHORT]
                        </div>
                      </div>
                    </div>
                    <p>
                      To show the field content for these entries, we must define
                      the <span class="mono">juris-title-short</span> component.
                    </p>
                    <p>
                      To gracefully negotiate the two layers of
                      abbreviation described in the previous section,
                      the <span class="mono">juris-title-short</span>
                      component requires a little more code than its
                      long-form cousin: but the logic to be applied is
                      straightfoward. The
                      <span class="mono">title-short</span> variable
                      is tightly bound to the <b>Short Title</b> field,
                      and it will test <code>false</code> if the field is
                      empty. If we also remember that the <code>form="short"</code>
                      attribute should be used only on the <span class="mono">legal_case</span>
                      type, the conditions are easy enough to compose. The following conditions
                      and <code>cs:text</code> elements will produce the effect we're after:
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-title-short"&gt;
  &lt;choose&gt;
    &lt;if match="all" type="legal_case" variable="title-short"&gt;
      &lt;text variable="title-short" form="short"/&gt;
    &lt;/if&gt;
    &lt;else-if type="legal_case"&gt;
      &lt;text variable="title" form="short"/&gt;
    &lt;/else-if&gt;
    &lt;else-if variable="title-short"&gt;
      &lt;text variable="title-short"/&gt;
    &lt;/else-if&gt;
    &lt;else&gt;
      &lt;text variable="title"/&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                    <p>
                      To test the logic, set the <span class="tabby">Sampler</span> to the
                      <b>Case</b> type, and drag the <span class="buttony bubble">Short Title</span>
                      field out of the <b>Included fields</b> box. The style should use the
                      content of the <span class="buttony bubble">Case Name</span> field when
                      the shortened name is not available.
                    </p>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Short-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-main-short"><a class="return-link" href="#banner"><span class="mono">juris-main-short</span></a></h2>
                    <p>
                      For
                      the <span class="mono">juris-main-short</span>
                      component, we delve again into our copy
                      of <span class="small-caps">The Atlantis
                      Guide</span>, and confirm the short form of our
                      two sample citations.  When a pinpoint locator
                      is used, they should be written as follows
                      (highlighting added to mark the portion to be
                      rendered by
                      the <span class="mono">juris-main-short</span>
                      component):
                    </p>
                    <div class="well well-sm">
                      <i>Int’l Shoe</i>, <span class="boxy yellowish">90 L. Ed.</span> at 100
                    </div>
                    <div class="well well-sm">
                      Sherwood Act, § 9
                    </div>
                    <p>
                      Well, how about
                      that&mdash;the <span class="mono">juris-main-short</span>
                      component is completely empty in <b>Gazette</b>
                      citations. Accordingly, we set an empty
                      condition for that type of input, and
                      use <code>cs:group</code> to join the two
                      elements needed for citations of the <b>Case</b>
                      type.
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-main-short"&gt;
  &lt;choose&gt;
    &lt;if type="gazette"/&gt;
    &lt;else&gt;
      &lt;group delimiter=" "&gt;
        &lt;number variable="volume"/&gt;
        &lt;text variable="container-title" form="short"/&gt;
      &lt;/group&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Short-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-default-spotter-short"><a class="return-link" href="#banner"><span class="mono">juris-default-spotter-short</span></a></h2>
                    <p>
                      The most important block in the three-part test
                      in this component is the first, which provides
                      the text that completes a short-form
                      citation. In both of the citation types in the
                      kindom of <span class="mono">Atlantis</span>,
                      this is a bare page number.
                    </p>
                    <p>
                      The other two test blocks provide the
                      appropriate details for a subsequent short-form
                      citation in our native style. These code blocks
                      are not actually used by the sample scaffolding
                      in the module template. This will be common,
                      since short-form and back-reference conventions
                      vary significantly among native styles. For
                      readability, the style calling module code will
                      often impose its own patterns consistently to
                      all short-form citations, by-passing native code.
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-default-spotter-short"&gt;
  &lt;choose&gt;
    &lt;if match="none" variable="locator"&gt;
      &lt;number variable="page-first"/&gt;
    &lt;/if&gt;
    &lt;else-if locator="page"&gt;
      &lt;group delimiter=" "&gt;
        &lt;text value="at"/&gt;
        &lt;text variable="locator"/&gt;
      &lt;/group&gt;
    &lt;/else-if&gt;
    &lt;else&gt;
      &lt;text macro="juris-default-spotter"/&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Short-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-comma-spotter-short"><a class="return-link" href="#banner"><span class="mono">juris-comma-spotter-short</span></a></h2>
                    <p>
                      There is not much to see here. Pinpoint locators
                      on short-form citations for
                      the <span class="small-caps">Atlantis</span>
                      jurisdiction are never set off by a comma, so
                      this component just returns an empty string.
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-comma-spotter-short"&gt;
  &lt;text value=""/&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Short-form components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-tail-short"><a class="return-link" href="#banner"><span class="mono">juris-tail-short</span></a></h2>
                    <p>
                      There is not much to see here either. Neither of the citation forms
                      in the <span class="small-caps">Atlantis</span> jurisdiction
                      place anything after the pinpoint locator in short-form citations,
                      so this component also returns an empty string.
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-tail-short"&gt;
  &lt;text value=""/&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;margin-bottom:10px;"/>
                  <hr style="border:0 none;border-top:1px solid #000000;margin-top:10px;"/>

                  <h3>Fragment components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-locator-label"><a class="return-link" href="#banner"><span class="mono">juris-locator-label</span></a></h2>
                    <p>
                      Each &ldquo;ancestor&rdquo; style that calls our
                      module will have its own method of constructing
                      back-references.  In some circumstances, its
                      scaffolding will give special treatment to a
                      locator that has no label in the native format
                      delivered by the module. For example, an
                      immediate back-reference to
                      an <span class="small-caps">Atlantis</span> case
                      cited in Bluebook scaffolding and pinpointed by
                      page number should look like this:
                    </p>
                    <div class="well well-sm">
                      <i>Id</i>. at 456.
                    </div>
                    <p>
                      The &ldquo;at&rdquo; cannot be supplied by the
                      module code, because it is a specific feature of
                      the Bluebook scaffolding: another
                      &ldquo;ancestor&rdquo; style might construct
                      immediate back-references in a completely
                      different way.
                    </p>
                    <p>
                      To solve this problem,
                      the <span class="mono">juris-locator-label</span>
                      component delivers the bare label <i>of the
                      module</i> (which may be empty); and if
                      it <i>is</i> empty, the scaffolding of the
                      calling style can add a supplementary label of
                      its own using the following construct:
                    </p>
                    <pre><code class="xml">&lt;text macro="juris-locator-label" 
      alternative-macro="my-at-label"/&gt;</code></pre>

                    <p>
                      In <span class="small-caps">Atlantis</span>
                      references, page numbers have no label, so this
                      component is cast as a simple condition
                      statement that renders nothing if the locator is
                      a page, and otherwise the label.
                    </p>
                    
                    <pre><code class="xml">&lt;macro name="juris-locator-label"&gt;
  &lt;choose&gt;
    &lt;if locator="page"/&gt;
    &lt;else&gt;
      &lt;label variable="locator" form="symbol"/&gt;
    &lt;/else&gt;
  &lt;/choose&gt;
&lt;/macro&gt;</code></pre>
                  </div>

                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <h3>Fragment components</h3>
                  <div class="multi-column">
                    <h2 id="guidance-locator"><a class="return-link" href="#banner"><span class="mono">juris-locator</span></a></h2>
                    <p>
                      In situations like that described in the section above,
                      the scaffolding in an &ldquo;ancestor&rdquo; style must
                      have a means of setting the bare pinpoint locator in
                      the module format, without any label.
                    </p>
                    <p>
                      Calling the <span class="mono">locator</span>
                      variable directly may seem the obvious thing to
                      do, but some jurisdictions
                      require <i>affixes</i> on the locator, even when
                      it has no label. For example, modern English
                      cases number passages by paragraph number, and
                      the pinpoint paragraph is enclosed in square
                      braces, thus:
                    </p>
                    <div class="well well-sm">
                      <i>Callery v Gray</i> [2001] EWCA Civ 1117 [42]
                    </div>
                    <p>
                      In the <span class="small-caps">Atlantis</span> citation
                      style, we do not apply affixes to our locators; but if we
                      must nonetheless &ldquo;play cricket&rdquo; by supplying
                      this macro, we can just return the bare locator, so that
                      is what we do.
                    </p>
                    <pre><code class="xml">&lt;macro name="juris-locator"&gt;
  &lt;number variable="locator"/&gt;
&lt;/macro&gt;</code></pre>
                  </div>
                  

                  <hr style="border:0 none;border-top:1px solid #000000;margin-bottom:10px;"/>
                  <hr style="border:0 none;border-top:1px solid #000000;margin-top:10px;"/>
                  <h2 id="guidance-results"><a class="return-link" href="#banner">Test Results</a></h2>
                  <div class="multi-column">
                    <p>
                      And ... that's it! Our freshly minted module
                      should be producing correct citations for both
                      item types, adapting gracefully to changes in
                      field content and in the pinpoint
                      identifiers. Check it out&mdash;you should see
                      results like those shown below.
                    </p>
                    <p>
                      This tutorial has introduced the modular
                      architecture of the Juris-M legal style
                      system, and covered the essential structures
                      needed for style authoring.  There is more to
                      Juris-M CSL than we have been able to cover
                      here, but the links under the <b>Docs</b> link
                      above provide a comprehensive treatment of the
                      language. If you get stuck, submit what you have
                      to GitHub, and we can discuss possible solutions
                      there.
                    </p>
                    <div class="well greenish">
                      Thank you for your time and attention, and
                      welcome to the Juris-M circle!
                    </div>
                  </div>
                  <hr style="border:0 none;border-top:1px solid #000000;"/>
                  <div class="multi-column">
                    <p>
                      <b>Case</b> type:
                    </p>

                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Full plain</div>
                        <div>
                          Int’l Shoe Co. v. Wash., 90 L. Ed. 95 (Sup. Ct. 1945)
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Full with locator</div>
                        <div>
                          Int’l Shoe Co. v. Wash., 90 L. Ed. 95, 100 (Sup. Ct. 1945)
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Ibid plain</div>
                        <div>
                          Ibid.
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Ibid with locator</div>
                        <div>
                          Ibid. at 100
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Supra plain</div>
                        <div>
                          <i>Int’l Shoe</i>, 90 L. Ed. 95
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Supra with locator</div>
                        <div>
                          <i>Int’l Shoe</i>, 90 L. Ed. at 100
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Far plain</div>
                        <div>
                          Int’l Shoe Co. v. Wash., 90 L. Ed. 95 (Sup. Ct. 1945)
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Far with locator</div>
                        <div>
                          Int’l Shoe Co. v. Wash., 90 L. Ed. 95, 100 (Sup. Ct. 1945)
                        </div>
                      </div>
                    </div>

                    <p>
                      <b>Gazette</b> type:
                    </p>

                    <div class="well">
                      <div class="indent">
                        <div class="small-faint-heading">Full plain</div>
                        <div>
                          Sherwood Act, ch. 123, § 9, 37 Stat. 112 (1912)
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Full with locator</div>
                        <div>
                          Sherwood Act, ch. 123, §§ 9 & 10, 37 Stat. 112, 115 (1912)
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Ibid plain</div>
                        <div>
                          Ibid.
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Ibid with locator</div>
                        <div>
                          Ibid. §§ 9 & 10
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Supra plain</div>
                        <div>
                          Sherwood Act, § 9
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Supra with locator</div>
                        <div>
                          Sherwood Act, §§ 9 & 10
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Far plain</div>
                        <div>
                          Sherwood Act, ch. 123, § 9, 37 Stat. 112 (1912)
                        </div>
                      </div>
                      <div class="indent">
                        <div class="small-faint-heading">Far with locator</div>
                        <div>
                          Sherwood Act, ch. 123, §§ 9 & 10, 37 Stat. 112, 115 (1912)
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
                <div id="source-editor" style="display:none;">
                </div>
              </div>
	          <div id="errors">
		        <ol id="error-list"></ol>
	          </div>
		      <div id="sampler">
                <div class="row">
                  <div id="sampler-preview" class="col-lg-6">
                    <div class="row"><div class="col-lg-12"><b id="style-name">My Style</b></div></div>
                    <div class="row">
                      <div class="col-lg-12">
                        <div class="btn-group">
                          <button id="sampler-itemtype-button" type="button" value="legal_case" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                            Case <span class="caret"></span>
                          </button>
                          <ul id="sampler-itemtype-dropdown" class="dropdown-menu" role="menu" onclick="CSLValidator.changeSamplerItemType(event);">
                            <!-- item types -->
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div class="row"><div class="col-lg-12"><div id="cheat-sheet-arrow" style="display:none;">&#10173;&nbsp;&#10173;&nbsp;&#10173;&nbsp;<a id="cheat-sheet" class="cheater-link">Cheat&nbsp;Sheet</a></div><h3 style="margin-top:5px;">Citations</h3></div></div>
                    <div class="row">
                      <div class="col-lg-12">
                        <div class="small-faint-heading">Full plain</div>
                        <div class="sampler-citation full-plain"></div>
                        <div class="small-faint-heading">Full with locator</div>
                        <div class="sampler-citation full-locator"></div>
                        <div class="small-faint-heading">Ibid plain</div>
                        <div class="sampler-citation ibid-plain"></div>
                        <div class="small-faint-heading">Ibid with locator</div>
                        <div class="sampler-citation ibid-locator"></div>
                        <div class="small-faint-heading">Supra plain</div>
                        <div class="sampler-citation supra-plain"></div>
                        <div class="small-faint-heading">Supra with locator</div>
                        <div class="sampler-citation supra-locator"></div>
                        <div class="small-faint-heading">Far plain</div>
                        <div class="sampler-citation far-plain"></div>
                        <div class="small-faint-heading">Far with locator</div>
                        <div class="sampler-citation far-locator"></div>
                      </div>
                    </div>
                    <div class="row"><div class="col-lg-12"><h3>Bibliography</h3></div></div>
                    <div class="row">
                      <div id="sampler-bibliography" class="col-lg-12">
                        <!-- bibliography entries -->
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="row">
                      <div class="col-xs-12">
                        <div class="small-note">drag fields to add or remove them</div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-xs-6">
                        <div class="row">
                          <div class="col-xs-12">
                            <h4>Included fields</h4>
                          </div>
                        </div>
                        <div class="row">
                          <div id="selected-csl-variables" class="col-xs-12 droppable">
                            <!-- selected bubbles -->
                          </div>
                        </div>
                      </div>
                      <div class="col-xs-6">
                        <div class="row">
                          <div class="col-xs-12">
                            <h4>Excluded fields</h4>
                          </div>
                        </div>
                        <div class="row">
                          <div id="unselected-csl-variables" class="col-xs-12 droppable">
                            <!-- unselected bubbles -->
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
	          </div>
            </div>
          </div>
        </div>
      </div>
      <div id="fields-view" class="container action-view" style="display:none;">
      </div>
    </div>
    <script src="../js/github-lib.js"></script>
  </body>
</html>
